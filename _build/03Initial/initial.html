---
redirect_from:
  - "/03initial/initial"
interact_link: content/03Initial/initial.ipynb
kernel_name: python3
kernel_path: content/03Initial
has_widgets: false
title: |-
  Initial Web Scraping
pagenum: 2
prev_page:
  url: /02Set_up_the_Databases/databases.html
next_page:
  url: /04Scheduled/scheduled.html
suffix: .ipynb
search: code initial web scraping made using following beautifulsoup library helped us scrape data needed pymongo used connect our database click toggle button view

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Initial Web Scraping</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The initial web scraping was made using the following code. <strong>BeautifulSoup</strong> is the library that helped us scrape the data we needed. <strong>Pymongo</strong> is used to connect to our database. You can click the toggle button to view the code.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered tag_hide_input">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">get</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pymongo</span>
<span class="kn">from</span> <span class="nn">pymongo</span> <span class="kn">import</span> <span class="n">MongoClient</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span>
            <span class="s1">&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit</span><span class="se">\</span>
<span class="s1">/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36&#39;</span><span class="p">})</span>


<span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span><span class="s2">&quot;Make&quot;</span><span class="p">,</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span><span class="s2">&quot;Body&quot;</span><span class="p">,</span><span class="s2">&quot;First Registration&quot;</span><span class="p">,</span><span class="s2">&quot;Fuel&quot;</span><span class="p">,</span><span class="s2">&quot;Mileage&quot;</span><span class="p">,</span><span class="s2">&quot;Power(hp)&quot;</span><span class="p">,</span>
<span class="s2">&quot;Gearing Type&quot;</span><span class="p">,</span><span class="s2">&quot;Displacement&quot;</span><span class="p">,</span><span class="s2">&quot;Warranty&quot;</span><span class="p">,</span><span class="s2">&quot;Full Service&quot;</span><span class="p">,</span><span class="s2">&quot;Non-smoking Vehicle&quot;</span><span class="p">,</span>
<span class="s2">&quot;Model Code&quot;</span><span class="p">,</span><span class="s2">&quot;ABS&quot;</span><span class="p">,</span><span class="s2">&quot;Driver-side airbag&quot;</span><span class="p">,</span><span class="s2">&quot;Passenger-side airbag&quot;</span><span class="p">,</span>
<span class="s2">&quot;Sunroof&quot;</span><span class="p">,</span><span class="s2">&quot;Radio&quot;</span><span class="p">,</span><span class="s2">&quot;4WD&quot;</span><span class="p">,</span><span class="s2">&quot;Power windows&quot;</span><span class="p">,</span><span class="s2">&quot;Alloy wheels&quot;</span><span class="p">,</span><span class="s2">&quot;Central door lock&quot;</span><span class="p">,</span><span class="s2">&quot;Alarm system&quot;</span><span class="p">,</span>
<span class="s2">&quot;Navigation system&quot;</span><span class="p">,</span><span class="s2">&quot;Immobilizer&quot;</span><span class="p">,</span><span class="s2">&quot;Side airbag&quot;</span><span class="p">,</span><span class="s2">&quot;Seat heating&quot;</span><span class="p">,</span><span class="s2">&quot;Disabled accessible&quot;</span><span class="p">,</span><span class="s2">&quot;Cruise control&quot;</span><span class="p">,</span>
<span class="s2">&quot;Xenon headlights&quot;</span><span class="p">,</span><span class="s2">&quot;On-board computer&quot;</span><span class="p">,</span><span class="s2">&quot;Electronic stability control&quot;</span><span class="p">,</span><span class="s2">&quot;Fog lights&quot;</span><span class="p">,</span><span class="s2">&quot;Trailer hitch&quot;</span><span class="p">,</span><span class="s2">&quot;Air conditioning&quot;</span><span class="p">,</span>
<span class="s2">&quot;Roof rack&quot;</span><span class="p">,</span><span class="s2">&quot;Power steering&quot;</span><span class="p">,</span><span class="s2">&quot;Automatic climate control&quot;</span><span class="p">,</span><span class="s2">&quot;Traction control&quot;</span><span class="p">,</span><span class="s2">&quot;Electrically adjustable seats&quot;</span><span class="p">,</span>
<span class="s2">&quot;MP3&quot;</span><span class="p">,</span><span class="s2">&quot;Panorama roof&quot;</span><span class="p">,</span><span class="s2">&quot;Auxiliary heating&quot;</span><span class="p">,</span><span class="s2">&quot;Sport package&quot;</span><span class="p">,</span><span class="s2">&quot;Start-stop system&quot;</span><span class="p">,</span><span class="s2">&quot;Multi-function steering wheel&quot;</span><span class="p">,</span>
<span class="s2">&quot;Daytime running lights&quot;</span><span class="p">,</span><span class="s2">&quot;Sport suspension&quot;</span><span class="p">,</span><span class="s2">&quot;Sport seats&quot;</span><span class="p">,</span>
<span class="s2">&quot;Adaptive headlights&quot;</span><span class="p">,</span><span class="s2">&quot;Ski bag&quot;</span><span class="p">,</span><span class="s2">&quot;Adaptive Cruise Control&quot;</span><span class="p">,</span>
<span class="s2">&quot;Armrest&quot;</span><span class="p">,</span><span class="s2">&quot;Electrically heated windshield&quot;</span><span class="p">,</span> <span class="s2">&quot;Heated steering wheel&quot;</span><span class="p">,</span>
<span class="s2">&quot;Hill Holder&quot;</span><span class="p">,</span><span class="s2">&quot;Digital radio&quot;</span><span class="p">,</span><span class="s2">&quot;LED Headlights&quot;</span><span class="p">,</span><span class="s2">&quot;Electric tailgate&quot;</span><span class="p">,</span>
<span class="s2">&quot;LED Daytime Running Lights&quot;</span><span class="p">,</span><span class="s2">&quot;Leather steering wheel&quot;</span><span class="p">,</span>
<span class="s2">&quot;Air suspension&quot;</span><span class="p">,</span><span class="s2">&quot;Massage seats&quot;</span><span class="p">,</span><span class="s2">&quot;Night view assist&quot;</span><span class="p">,</span><span class="s2">&quot;Tire pressure monitoring system&quot;</span><span class="p">,</span>
<span class="s2">&quot;Keyless central door lock&quot;</span><span class="p">,</span><span class="s2">&quot;Lane departure warning system&quot;</span><span class="p">,</span>
<span class="s2">&quot;Blind spot monitor&quot;</span><span class="p">,</span><span class="s2">&quot;Touch screen&quot;</span><span class="p">,</span><span class="s2">&quot;USB&quot;</span><span class="p">,</span><span class="s2">&quot;Traffic sign recognition&quot;</span><span class="p">,</span>
<span class="s2">&quot;Electrical side mirrors&quot;</span><span class="p">,</span><span class="s2">&quot;Bluetooth&quot;</span><span class="p">,</span><span class="s2">&quot;Isofix&quot;</span><span class="p">,</span><span class="s2">&quot;Rain sensor&quot;</span><span class="p">,</span>
<span class="s2">&quot;Parking assist system sensors front&quot;</span><span class="p">,</span><span class="s2">&quot;Parking assist system sensors rear&quot;</span><span class="p">,</span>
<span class="s2">&quot;Parking assist system camera&quot;</span><span class="p">,</span><span class="s2">&quot;Parking assist system self-steering&quot;</span><span class="p">,</span>
<span class="s2">&quot;CD player&quot;</span><span class="p">,</span><span class="s2">&quot;Price&quot;</span><span class="p">]</span>

<span class="n">car_metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span><span class="s2">&quot;Make&quot;</span><span class="p">,</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span><span class="s2">&quot;Body&quot;</span><span class="p">,</span><span class="s2">&quot;First Registration&quot;</span><span class="p">,</span><span class="s2">&quot;Fuel&quot;</span><span class="p">,</span><span class="s2">&quot;Mileage&quot;</span><span class="p">,</span><span class="s2">&quot;Power(hp)&quot;</span><span class="p">,</span>
<span class="s2">&quot;Gearing Type&quot;</span><span class="p">,</span><span class="s2">&quot;Displacement&quot;</span><span class="p">,</span><span class="s2">&quot;Warranty&quot;</span><span class="p">,</span><span class="s2">&quot;Full Service&quot;</span><span class="p">,</span><span class="s2">&quot;Non-smoking Vehicle&quot;</span><span class="p">,</span>
<span class="s2">&quot;Model Code&quot;</span><span class="p">,</span><span class="s2">&quot;Price&quot;</span><span class="p">]</span>

<span class="n">eq_metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AdID&quot;</span><span class="p">,</span><span class="s2">&quot;ABS&quot;</span><span class="p">,</span><span class="s2">&quot;Driver-side airbag&quot;</span><span class="p">,</span><span class="s2">&quot;Passenger-side airbag&quot;</span><span class="p">,</span>
<span class="s2">&quot;Sunroof&quot;</span><span class="p">,</span><span class="s2">&quot;Radio&quot;</span><span class="p">,</span><span class="s2">&quot;4WD&quot;</span><span class="p">,</span><span class="s2">&quot;Power windows&quot;</span><span class="p">,</span><span class="s2">&quot;Alloy wheels&quot;</span><span class="p">,</span><span class="s2">&quot;Central door lock&quot;</span><span class="p">,</span><span class="s2">&quot;Alarm system&quot;</span><span class="p">,</span>
<span class="s2">&quot;Navigation system&quot;</span><span class="p">,</span><span class="s2">&quot;Immobilizer&quot;</span><span class="p">,</span><span class="s2">&quot;Side airbag&quot;</span><span class="p">,</span><span class="s2">&quot;Seat heating&quot;</span><span class="p">,</span><span class="s2">&quot;Disabled accessible&quot;</span><span class="p">,</span><span class="s2">&quot;Cruise control&quot;</span><span class="p">,</span>
<span class="s2">&quot;Xenon headlights&quot;</span><span class="p">,</span><span class="s2">&quot;On-board computer&quot;</span><span class="p">,</span><span class="s2">&quot;Electronic stability control&quot;</span><span class="p">,</span><span class="s2">&quot;Fog lights&quot;</span><span class="p">,</span><span class="s2">&quot;Trailer hitch&quot;</span><span class="p">,</span><span class="s2">&quot;Air conditioning&quot;</span><span class="p">,</span>
<span class="s2">&quot;Roof rack&quot;</span><span class="p">,</span><span class="s2">&quot;Power steering&quot;</span><span class="p">,</span><span class="s2">&quot;Automatic climate control&quot;</span><span class="p">,</span><span class="s2">&quot;Traction control&quot;</span><span class="p">,</span><span class="s2">&quot;Electrically adjustable seats&quot;</span><span class="p">,</span>
<span class="s2">&quot;MP3&quot;</span><span class="p">,</span><span class="s2">&quot;Panorama roof&quot;</span><span class="p">,</span><span class="s2">&quot;Auxiliary heating&quot;</span><span class="p">,</span><span class="s2">&quot;Sport package&quot;</span><span class="p">,</span><span class="s2">&quot;Start-stop system&quot;</span><span class="p">,</span><span class="s2">&quot;Multi-function steering wheel&quot;</span><span class="p">,</span>
<span class="s2">&quot;Daytime running lights&quot;</span><span class="p">,</span><span class="s2">&quot;Sport suspension&quot;</span><span class="p">,</span><span class="s2">&quot;Sport seats&quot;</span><span class="p">,</span>
<span class="s2">&quot;Adaptive headlights&quot;</span><span class="p">,</span><span class="s2">&quot;Ski bag&quot;</span><span class="p">,</span><span class="s2">&quot;Adaptive Cruise Control&quot;</span><span class="p">,</span>
<span class="s2">&quot;Armrest&quot;</span><span class="p">,</span><span class="s2">&quot;Electrically heated windshield&quot;</span><span class="p">,</span> <span class="s2">&quot;Heated steering wheel&quot;</span><span class="p">,</span>
<span class="s2">&quot;Hill Holder&quot;</span><span class="p">,</span><span class="s2">&quot;Digital radio&quot;</span><span class="p">,</span><span class="s2">&quot;LED Headlights&quot;</span><span class="p">,</span><span class="s2">&quot;Electric tailgate&quot;</span><span class="p">,</span>
<span class="s2">&quot;LED Daytime Running Lights&quot;</span><span class="p">,</span><span class="s2">&quot;Leather steering wheel&quot;</span><span class="p">,</span>
<span class="s2">&quot;Air suspension&quot;</span><span class="p">,</span><span class="s2">&quot;Massage seats&quot;</span><span class="p">,</span><span class="s2">&quot;Night view assist&quot;</span><span class="p">,</span><span class="s2">&quot;Tire pressure monitoring system&quot;</span><span class="p">,</span>
<span class="s2">&quot;Keyless central door lock&quot;</span><span class="p">,</span><span class="s2">&quot;Lane departure warning system&quot;</span><span class="p">,</span>
<span class="s2">&quot;Blind spot monitor&quot;</span><span class="p">,</span><span class="s2">&quot;Touch screen&quot;</span><span class="p">,</span><span class="s2">&quot;USB&quot;</span><span class="p">,</span><span class="s2">&quot;Traffic sign recognition&quot;</span><span class="p">,</span>
<span class="s2">&quot;Electrical side mirrors&quot;</span><span class="p">,</span><span class="s2">&quot;Bluetooth&quot;</span><span class="p">,</span><span class="s2">&quot;Isofix&quot;</span><span class="p">,</span><span class="s2">&quot;Rain sensor&quot;</span><span class="p">,</span>
<span class="s2">&quot;Parking assist system sensors front&quot;</span><span class="p">,</span><span class="s2">&quot;Parking assist system sensors rear&quot;</span><span class="p">,</span>
<span class="s2">&quot;Parking assist system camera&quot;</span><span class="p">,</span><span class="s2">&quot;Parking assist system self-steering&quot;</span><span class="p">,</span>
<span class="s2">&quot;CD player&quot;</span><span class="p">]</span>

<span class="n">audi_models</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;100&#39;</span><span class="p">,</span><span class="s1">&#39;200&#39;</span><span class="p">,</span><span class="s1">&#39;50&#39;</span><span class="p">,</span><span class="s1">&#39;80&#39;</span><span class="p">,</span><span class="s1">&#39;90&#39;</span><span class="p">,</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span><span class="s1">&#39;A4-allroad&#39;</span><span class="p">,</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span><span class="s1">&#39;A8&#39;</span><span class="p">,</span><span class="s1">&#39;Allroad&#39;</span><span class="p">,</span><span class="s1">&#39;Cabriolet&#39;</span><span class="p">,</span><span class="s1">&#39;Coupe&#39;</span><span class="p">,</span><span class="s1">&#39;e-tron&#39;</span><span class="p">,</span><span class="s1">&#39;Q1&#39;</span>
                <span class="p">,</span><span class="s1">&#39;Q2&#39;</span><span class="p">,</span><span class="s1">&#39;Q3&#39;</span><span class="p">,</span><span class="s1">&#39;Q5&#39;</span><span class="p">,</span><span class="s1">&#39;Q7&#39;</span><span class="p">,</span><span class="s1">&#39;Q8&#39;</span><span class="p">,</span><span class="s1">&#39;QUATTRO&#39;</span><span class="p">,</span>
                <span class="s1">&#39;R8&#39;</span><span class="p">,</span><span class="s1">&#39;R5&#39;</span><span class="p">,</span><span class="s1">&#39;RS-Q3&#39;</span><span class="p">,</span><span class="s1">&#39;RS-Q5&#39;</span><span class="p">,</span><span class="s1">&#39;RS-Q8&#39;</span><span class="p">,</span><span class="s1">&#39;RS2&#39;</span><span class="p">,</span><span class="s1">&#39;RS3&#39;</span><span class="p">,</span><span class="s1">&#39;RS4&#39;</span><span class="p">,</span><span class="s1">&#39;RS5&#39;</span><span class="p">,</span><span class="s1">&#39;RS6&#39;</span><span class="p">,</span><span class="s1">&#39;RS7&#39;</span><span class="p">,</span><span class="s1">&#39;S1&#39;</span><span class="p">,</span><span class="s1">&#39;S2&#39;</span>
                <span class="p">,</span><span class="s1">&#39;S3&#39;</span><span class="p">,</span><span class="s1">&#39;S4&#39;</span><span class="p">,</span><span class="s1">&#39;S5&#39;</span><span class="p">,</span><span class="s1">&#39;S6&#39;</span><span class="p">,</span><span class="s1">&#39;S7&#39;</span><span class="p">,</span><span class="s1">&#39;S8&#39;</span><span class="p">,</span><span class="s1">&#39;SQ2&#39;</span><span class="p">,</span><span class="s1">&#39;SQ5&#39;</span><span class="p">,</span><span class="s1">&#39;SQ7&#39;</span><span class="p">,</span><span class="s1">&#39;SQ8&#39;</span><span class="p">,</span><span class="s1">&#39;TT&#39;</span><span class="p">,</span><span class="s1">&#39;TT-RS&#39;</span><span class="p">,</span><span class="s1">&#39;TTS&#39;</span><span class="p">,</span><span class="s1">&#39;V8&#39;</span><span class="p">]</span>



<span class="n">ford_models</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;aerostar&quot;</span><span class="p">,</span><span class="s2">&quot;b-max&quot;</span><span class="p">,</span><span class="s2">&quot;bronco&quot;</span><span class="p">,</span><span class="s2">&quot;c-max&quot;</span><span class="p">,</span><span class="s2">&quot;capri&quot;</span><span class="p">,</span><span class="s2">&quot;connect-elekto&quot;</span><span class="p">,</span><span class="s2">&quot;consul&quot;</span><span class="p">,</span><span class="s2">&quot;cougar&quot;</span><span class="p">,</span><span class="s2">&quot;courier&quot;</span><span class="p">,</span><span class="s2">&quot;crown&quot;</span><span class="p">,</span><span class="s2">&quot;econoline&quot;</span><span class="p">,</span>
               <span class="s2">&quot;econovan&quot;</span><span class="p">,</span><span class="s2">&quot;ecosport&quot;</span><span class="p">,</span><span class="s2">&quot;edge&quot;</span><span class="p">,</span><span class="s2">&quot;escape&quot;</span><span class="p">,</span><span class="s2">&quot;escort&quot;</span><span class="p">,</span><span class="s2">&quot;excursion&quot;</span><span class="p">,</span><span class="s2">&quot;expedition&quot;</span><span class="p">,</span><span class="s2">&quot;explorer&quot;</span><span class="p">,</span><span class="s2">&quot;express&quot;</span><span class="p">,</span><span class="s2">&quot;f-1&quot;</span><span class="p">,</span><span class="s2">&quot;f-100&quot;</span>
                <span class="p">,</span><span class="s2">&quot;f-150&quot;</span><span class="p">,</span><span class="s2">&quot;f-250&quot;</span><span class="p">,</span><span class="s2">&quot;f-350&quot;</span><span class="p">,</span><span class="s2">&quot;f-360&quot;</span><span class="p">,</span><span class="s2">&quot;f-450&quot;</span><span class="p">,</span><span class="s2">&quot;f-550&quot;</span><span class="p">,</span><span class="s2">&quot;f-650&quot;</span><span class="p">,</span><span class="s2">&quot;f-super-duty&quot;</span><span class="p">,</span><span class="s2">&quot;fairlane&quot;</span><span class="p">,</span><span class="s2">&quot;falcon&quot;</span><span class="p">,</span><span class="s2">&quot;fiesta&quot;</span><span class="p">,</span><span class="s2">&quot;flex&quot;</span>
                <span class="p">,</span><span class="s2">&quot;focus&quot;</span><span class="p">,</span><span class="s2">&quot;focus-c-max&quot;</span><span class="p">,</span><span class="s2">&quot;focus-cc&quot;</span><span class="p">,</span><span class="s2">&quot;freestar&quot;</span><span class="p">,</span><span class="s2">&quot;freestyle&quot;</span><span class="p">,</span><span class="s2">&quot;fusion&quot;</span><span class="p">,</span><span class="s2">&quot;galaxy&quot;</span><span class="p">,</span><span class="s2">&quot;gran-torino&quot;</span><span class="p">,</span><span class="s2">&quot;granada&quot;</span><span class="p">,</span><span class="s2">&quot;grand-c-max&quot;</span>
                <span class="p">,</span><span class="s2">&quot;gt&quot;</span><span class="p">,</span><span class="s2">&quot;ka/ka+&quot;</span><span class="p">,</span><span class="s2">&quot;kuga&quot;</span><span class="p">,</span><span class="s2">&quot;m&quot;</span><span class="p">,</span><span class="s2">&quot;maverick&quot;</span><span class="p">,</span><span class="s2">&quot;mercury&quot;</span><span class="p">,</span><span class="s2">&quot;mondeo&quot;</span><span class="p">,</span><span class="s2">&quot;mustang&quot;</span><span class="p">,</span><span class="s2">&quot;orion&quot;</span><span class="p">,</span><span class="s2">&quot;probe&quot;</span><span class="p">,</span><span class="s2">&quot;puma&quot;</span><span class="p">,</span><span class="s2">&quot;ranger&quot;</span><span class="p">,</span><span class="s2">&quot;rs-200&quot;</span><span class="p">,</span>
               <span class="s2">&quot;s-max&quot;</span><span class="p">,</span><span class="s2">&quot;scorpio&quot;</span><span class="p">,</span><span class="s2">&quot;sierra&quot;</span><span class="p">,</span><span class="s2">&quot;sportka&quot;</span><span class="p">,</span><span class="s2">&quot;streetka&quot;</span><span class="p">,</span><span class="s2">&quot;taunus&quot;</span><span class="p">,</span><span class="s2">&quot;taurus&quot;</span><span class="p">,</span><span class="s2">&quot;thunderbird&quot;</span><span class="p">,</span><span class="s2">&quot;torino&quot;</span><span class="p">,</span><span class="s2">&quot;tourneo-(all)&quot;</span><span class="p">,</span><span class="s2">&quot;tourneo&quot;</span>
                <span class="p">,</span><span class="s2">&quot;tourneo-connect&quot;</span><span class="p">,</span><span class="s2">&quot;tourneo-courier&quot;</span><span class="p">,</span><span class="s2">&quot;tourneo-custom&quot;</span><span class="p">,</span><span class="s2">&quot;transit-(all)&quot;</span><span class="p">,</span><span class="s2">&quot;transit&quot;</span><span class="p">,</span><span class="s2">&quot;transit-bus&quot;</span><span class="p">,</span><span class="s2">&quot;transit-connect&quot;</span>
                <span class="p">,</span><span class="s2">&quot;transit-courier&quot;</span><span class="p">,</span><span class="s2">&quot;transit-custom&quot;</span><span class="p">,</span><span class="s2">&quot;windstar&quot;</span><span class="p">]</span>

<span class="n">seat_models</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Alhambra&quot;</span><span class="p">,</span><span class="s2">&quot;Altea&quot;</span><span class="p">,</span><span class="s2">&quot;Altea-XL&quot;</span><span class="p">,</span><span class="s2">&quot;Arona&quot;</span><span class="p">,</span><span class="s2">&quot;Arosa&quot;</span><span class="p">,</span><span class="s2">&quot;Ateca&quot;</span><span class="p">,</span><span class="s2">&quot;Cordoba&quot;</span><span class="p">,</span><span class="s2">&quot;Exeo&quot;</span><span class="p">,</span><span class="s2">&quot;Fura&quot;</span><span class="p">,</span><span class="s2">&quot;Ibiza&quot;</span><span class="p">,</span><span class="s2">&quot;Inca&quot;</span><span class="p">,</span><span class="s2">&quot;Leon&quot;</span><span class="p">,</span><span class="s2">&quot;Malaga&quot;</span><span class="p">,</span>
               <span class="s2">&quot;Marbella&quot;</span><span class="p">,</span><span class="s2">&quot;Mii&quot;</span><span class="p">,</span><span class="s2">&quot;Panda&quot;</span><span class="p">,</span><span class="s2">&quot;Ronda&quot;</span><span class="p">,</span><span class="s2">&quot;Tarraco&quot;</span><span class="p">,</span><span class="s2">&quot;Terra&quot;</span><span class="p">,</span><span class="s2">&quot;Toledo&quot;</span><span class="p">]</span>
<span class="n">model_dict</span><span class="o">=</span><span class="p">{}</span>
<span class="n">makes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Audi&quot;</span><span class="p">,</span> <span class="s2">&quot;Ford&quot;</span><span class="p">,</span><span class="s2">&quot;Seat&quot;</span><span class="p">]</span>
<span class="n">model_dict</span><span class="p">[</span><span class="s2">&quot;Audi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">audi_models</span>
<span class="n">model_dict</span><span class="p">[</span><span class="s2">&quot;Ford&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ford_models</span>
<span class="n">model_dict</span><span class="p">[</span><span class="s2">&quot;Seat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">seat_models</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.autoscout24.com&quot;</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;cars.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">c</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;equipment.csv&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">eq</span><span class="p">,</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;cars_simple.csv&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cs</span><span class="p">:</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONNUMERIC</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">writer2</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONNUMERIC</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">writer3</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONNUMERIC</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
    <span class="n">writer2</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">eq_metrics</span><span class="p">)</span>
    <span class="n">writer3</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">car_metrics</span><span class="p">)</span>
            
<span class="k">def</span> <span class="nf">baraj</span><span class="p">(</span><span class="n">make</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">year</span><span class="p">):</span>
    
    <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">):</span>
        <span class="n">base_url</span> <span class="o">=</span>  <span class="s2">&quot;https://www.autoscout24.com/lst/</span><span class="si">{0}</span><span class="s2">/</span><span class="si">{1}</span><span class="s2">?sort=standard&amp;desc=0&amp;ustate=N%2CU&amp;size=20&amp;page=</span><span class="si">{2}</span><span class="s2">&amp;fregto=</span><span class="si">{3}</span><span class="s2">&amp;fregfrom=</span><span class="si">{4}</span><span class="s2">&amp;atype=C&amp;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">make</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">page</span><span class="p">,</span><span class="n">year</span><span class="p">,</span><span class="n">year</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">html_soup1</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">html_soup1</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;cl-empty-listings-summary&#39;</span><span class="p">})</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">html_soup1</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,{</span><span class="s2">&quot;data-item-name&quot;</span><span class="p">:</span> <span class="s2">&quot;detail-page-link&quot;</span><span class="p">}):</span> <span class="c1">#sekoj poseben oglas</span>
                <span class="n">r</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">url1</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span>  <span class="c1">#linkot od oglasot</span>
                <span class="n">ID</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">split</span>  <span class="o">=</span> <span class="n">url1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">url1</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">pole</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">split</span><span class="p">)</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">split</span><span class="p">)):</span>
                        <span class="n">ID</span><span class="o">+=</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="n">pole</span><span class="p">])</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">url1</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
                <span class="n">html_soup1</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">html_soup1</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span><span class="s2">&quot;sc-font-l cldt-stage-primary-keyfact&quot;</span><span class="p">})</span>
                <span class="k">if</span><span class="p">(</span><span class="n">w</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
                    <span class="n">r</span><span class="p">[</span><span class="s2">&quot;Mileage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">w</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)))</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">html_soup1</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;basicDataFirstRegistrationValue&quot;</span><span class="p">})</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">w</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
                    <span class="n">r</span><span class="p">[</span><span class="s2">&quot;First Registration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">text</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">html_soup1</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span><span class="s2">&quot;sc-font-m cldt-stage-primary-keyfact&quot;</span><span class="p">})</span>
                <span class="k">if</span><span class="p">(</span><span class="n">w</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">w</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
                    <span class="n">r</span><span class="p">[</span><span class="s2">&quot;Power(hp)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">w</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])))</span>
                <span class="n">r</span><span class="p">[</span><span class="s2">&quot;Price&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">html_soup1</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;cldt-price&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;h2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">html_soup1</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span><span class="s2">&quot;cldt-equipment-block sc-grid-col-3 sc-grid-col-m-4 sc-grid-col-s-12 sc-pull-left&quot;</span><span class="p">}):</span>  <span class="c1">#dodatna oprema</span>
                    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">):</span>
                        <span class="c1">#print(b.text)</span>
                        <span class="n">r</span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">text</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">lst1</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">lst2</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">html_soup1</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;dl&#39;</span><span class="p">):</span> <span class="c1"># paramentri</span>
                    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">):</span>
                        <span class="c1">#print(b.text)</span>
                        <span class="n">lst1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">html_soup1</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;dl&#39;</span><span class="p">):</span> <span class="c1"># vrednosti</span>
                    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">):</span>
                        <span class="c1">#print(b.text.strip())</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
                            <span class="n">lst2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">lst2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>    

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">lst1</span><span class="p">)):</span> <span class="c1">#spojuvanje</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">lst1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Displacement&#39;</span><span class="p">):</span>
                        <span class="n">r</span><span class="p">[</span><span class="n">lst1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">lst2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
                    <span class="k">elif</span><span class="p">(</span><span class="n">lst1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;First Registration&#39;</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">r</span><span class="p">[</span><span class="n">lst1</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="n">lst2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                <span class="n">final</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">car_final</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">eq_final</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">final</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">ID</span>
                <span class="n">car_final</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">ID</span>
                <span class="n">eq_final</span><span class="p">[</span><span class="s2">&quot;AdID&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">ID</span>

                <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">metric</span> <span class="ow">in</span> <span class="n">r</span><span class="p">):</span>
                        <span class="n">final</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">metric</span><span class="o">==</span><span class="s2">&quot;ID&quot;</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">final</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">car_metrics</span><span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">metric</span> <span class="ow">in</span> <span class="n">r</span><span class="p">):</span>
                        <span class="n">car_final</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">metric</span><span class="o">==</span><span class="s2">&quot;ID&quot;</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">car_final</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">eq_metrics</span><span class="p">:</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">metric</span> <span class="ow">in</span> <span class="n">r</span><span class="p">):</span>
                        <span class="n">eq_final</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">metric</span><span class="o">==</span><span class="s2">&quot;AdID&quot;</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">eq_final</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;cars.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">c</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;equipment.csv&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">eq</span><span class="p">,</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;cars_simple.csv&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cs</span><span class="p">:</span>
                    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONNUMERIC</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                    <span class="n">writer2</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONNUMERIC</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                    <span class="n">writer3</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONNUMERIC</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">final</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
                    <span class="n">writer2</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">eq_final</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
                    <span class="n">writer3</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">car_final</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Empty query for make </span><span class="si">{0}</span><span class="s2">, model </span><span class="si">{1}</span><span class="s2">, year</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">make</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">year</span><span class="p">))</span>
            <span class="k">break</span>
    
      


<span class="k">for</span> <span class="n">make</span> <span class="ow">in</span> <span class="n">makes</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">model_dict</span><span class="p">[</span><span class="n">make</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="mi">2021</span><span class="p">):</span>
            <span class="n">baraj</span><span class="p">(</span><span class="n">make</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">year</span><span class="p">)</span>
            
<span class="c1">#Popolni &lt;username&gt; i &lt;pass&gt;</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">MongoClient</span><span class="p">(</span><span class="s1">&#39;mongodb://&lt;Username&gt;:&lt;Password&gt;@dwprojectcluster-shard-00-00.lpqbf.mongodb.net:27017,dwprojectcluster-shard-00-01.lpqbf.mongodb.net:27017,dwprojectcluster-shard-00-02.lpqbf.mongodb.net:27017/&lt;dbname&gt;?ssl=true&amp;replicaSet=atlas-672mwy-shard-0&amp;authSource=admin&amp;retryWrites=true&amp;w=majority&#39;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;cars.csv&#39;</span><span class="p">)</span>

<span class="c1">#Izbrisi prazni redovi</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">ID</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#Tabela bez prazni redovi</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;cars2.csv&#39;</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1">#Relativno posporo resenie od df.to_dict(&#39;records&#39;), megjutoa za razlika od nego gi ignorira NaN vrednostite.</span>
<span class="n">clean_dict_list</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">client</span><span class="o">.</span><span class="n">cars_database</span><span class="o">.</span><span class="n">cars</span><span class="o">.</span><span class="n">insert_many</span><span class="p">(</span><span class="n">clean_dict_list</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

 


    </main>
    